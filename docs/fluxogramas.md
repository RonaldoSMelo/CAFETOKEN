# 📊 CAFÉTOKEN - Fluxogramas de Processo

---

## 1. Fluxo do Produtor

```
┌─────────────────────────────────────────────────────────────────┐
│                    JORNADA DO PRODUTOR                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────┐                                                   │
│  │ INÍCIO  │                                                   │
│  └────┬────┘                                                   │
│       │                                                         │
│       ▼                                                         │
│  ┌─────────────┐                                               │
│  │  Acessa     │                                               │
│  │  Plataforma │                                               │
│  └──────┬──────┘                                               │
│         │                                                       │
│         ▼                                                       │
│  ┌─────────────┐     ┌─────────────┐                           │
│  │  Conecta    │────►│   Cadastra  │                           │
│  │   Wallet    │     │   Fazenda   │                           │
│  └─────────────┘     └──────┬──────┘                           │
│                             │                                   │
│                             ▼                                   │
│                      ┌─────────────┐                           │
│                      │  Cadastra   │                           │
│                      │  Microlote  │                           │
│                      └──────┬──────┘                           │
│                             │                                   │
│                             ▼                                   │
│                      ┌─────────────┐     ┌─────────────┐       │
│                      │  Aguarda    │────►│  Auditoria  │       │
│                      │  Auditoria  │     │  Externa    │       │
│                      └─────────────┘     └──────┬──────┘       │
│                                                 │               │
│                                    ┌────────────┼────────────┐  │
│                                    │            │            │  │
│                                    ▼            ▼            │  │
│                             ┌──────────┐ ┌──────────┐        │  │
│                             │ APROVADO │ │REPROVADO │        │  │
│                             └────┬─────┘ └────┬─────┘        │  │
│                                  │            │              │  │
│                                  ▼            ▼              │  │
│                           ┌──────────┐ ┌──────────┐          │  │
│                           │  NFT é   │ │ Corrige  │          │  │
│                           │ Mintado  │ │  Dados   │──────────┘  │
│                           └────┬─────┘ └──────────┘             │
│                                │                                │
│                                ▼                                │
│                         ┌──────────┐                           │
│                         │  Lista   │                           │
│                         │ no Mkt   │                           │
│                         └────┬─────┘                           │
│                              │                                  │
│                              ▼                                  │
│                       ┌──────────┐                             │
│                       │ Aguarda  │                             │
│                       │  Venda   │                             │
│                       └────┬─────┘                             │
│                            │                                    │
│                            ▼                                    │
│                     ┌──────────┐                               │
│                     │ Recebe   │                               │
│                     │Pagamento │                               │
│                     └────┬─────┘                               │
│                          │                                      │
│                          ▼                                      │
│                     ┌─────────┐                                │
│                     │   FIM   │                                │
│                     └─────────┘                                │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 2. Fluxo do Comprador

```
┌─────────────────────────────────────────────────────────────────┐
│                    JORNADA DO COMPRADOR                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────┐                                                   │
│  │ INÍCIO  │                                                   │
│  └────┬────┘                                                   │
│       │                                                         │
│       ▼                                                         │
│  ┌─────────────┐                                               │
│  │   Acessa    │                                               │
│  │ Marketplace │                                               │
│  └──────┬──────┘                                               │
│         │                                                       │
│         ▼                                                       │
│  ┌─────────────┐                                               │
│  │  Explora    │                                               │
│  │   Lotes     │◄─────────────────────────────┐                │
│  └──────┬──────┘                              │                │
│         │                                     │                │
│         ▼                                     │                │
│  ┌─────────────┐     ┌─────────────┐         │                │
│  │  Seleciona  │────►│  Visualiza  │         │                │
│  │    Lote     │     │  Detalhes   │         │                │
│  └─────────────┘     └──────┬──────┘         │                │
│                             │                │                │
│                    ┌────────┴────────┐       │                │
│                    │                 │       │                │
│                    ▼                 ▼       │                │
│             ┌──────────┐      ┌──────────┐   │                │
│             │  Compra  │      │  Volta   │───┘                │
│             └────┬─────┘      └──────────┘                    │
│                  │                                             │
│                  ▼                                             │
│           ┌──────────┐                                        │
│           │ Conecta  │                                        │
│           │  Wallet  │                                        │
│           └────┬─────┘                                        │
│                │                                               │
│                ▼                                               │
│         ┌──────────┐                                          │
│         │ Confirma │                                          │
│         │  Compra  │                                          │
│         └────┬─────┘                                          │
│              │                                                 │
│              ▼                                                 │
│       ┌──────────┐                                            │
│       │ NFT no   │                                            │
│       │ Wallet   │                                            │
│       └────┬─────┘                                            │
│            │                                                   │
│            ▼                                                   │
│   ┌────────────────┐                                          │
│   │  ESCOLHE AÇÃO  │                                          │
│   └───────┬────────┘                                          │
│           │                                                    │
│  ┌────────┼────────┬────────┐                                 │
│  │        │        │        │                                 │
│  ▼        ▼        ▼        ▼                                 │
│┌────┐ ┌──────┐ ┌──────┐ ┌──────┐                             │
││Hold│ │Revenda│ │Redeem│ │Leilão│                             │
│└────┘ └──────┘ └──────┘ └──────┘                             │
│                                                                │
└─────────────────────────────────────────────────────────────────┘
```

---

## 3. Fluxo de Mint do NFT

```
┌─────────────────────────────────────────────────────────────────┐
│                     PROCESSO DE MINT                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────┐                                           │
│  │  DADOS DO LOTE  │                                           │
│  │  ─────────────  │                                           │
│  │  • Código       │                                           │
│  │  • Produtor     │                                           │
│  │  • Peso         │                                           │
│  │  • SCA Score    │                                           │
│  │  • Certificados │                                           │
│  │  • Fotos        │                                           │
│  └────────┬────────┘                                           │
│           │                                                     │
│           ▼                                                     │
│  ┌─────────────────┐     ┌─────────────────┐                   │
│  │   VALIDAÇÃO     │────►│  UPLOAD IPFS    │                   │
│  │   AUDITORIA     │     │   (Pinata)      │                   │
│  └─────────────────┘     └────────┬────────┘                   │
│                                   │                             │
│                                   ▼                             │
│                          ┌─────────────────┐                   │
│                          │  METADATA JSON  │                   │
│                          │  ─────────────  │                   │
│                          │  ipfs://Qm...   │                   │
│                          └────────┬────────┘                   │
│                                   │                             │
│                                   ▼                             │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                  SMART CONTRACT                          │   │
│  │  ───────────────────────────────────────────────────    │   │
│  │                                                          │   │
│  │  function mintCoffeeLot(                                │   │
│  │      string tokenURI,                                   │   │
│  │      string lotCode,                                    │   │
│  │      uint256 weightKg,                                  │   │
│  │      uint256 scaScore,                                  │   │
│  │      string qualityHash                                 │   │
│  │  ) → tokenId                                            │   │
│  │                                                          │   │
│  └─────────────────────────────┬───────────────────────────┘   │
│                                │                                │
│                                ▼                                │
│                       ┌─────────────────┐                      │
│                       │   NFT CRIADO    │                      │
│                       │   ───────────   │                      │
│                       │   Token #42     │                      │
│                       │   Owner: 0x...  │                      │
│                       │   URI: ipfs://  │                      │
│                       └─────────────────┘                      │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 4. Fluxo de Compra no Marketplace

```
┌─────────────────────────────────────────────────────────────────┐
│                   FLUXO DE COMPRA                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   COMPRADOR              CONTRATO              VENDEDOR         │
│   ─────────              ────────              ────────         │
│       │                     │                     │             │
│       │  1. buyNFT()        │                     │             │
│       │  + value (ETH)      │                     │             │
│       │────────────────────►│                     │             │
│       │                     │                     │             │
│       │                     │  2. Verifica       │             │
│       │                     │     listing        │             │
│       │                     │     ativo          │             │
│       │                     │                     │             │
│       │                     │  3. Verifica       │             │
│       │                     │     valor >=       │             │
│       │                     │     preço          │             │
│       │                     │                     │             │
│       │                     │  4. Transfere      │             │
│       │                     │     NFT            │             │
│       │◄────────────────────│                     │             │
│       │                     │                     │             │
│       │                     │  5. Calcula taxa   │             │
│       │                     │     (3%)           │             │
│       │                     │                     │             │
│       │                     │  6. Transfere      │             │
│       │                     │     valor - taxa   │             │
│       │                     │────────────────────►│             │
│       │                     │                     │             │
│       │                     │  7. Emite evento   │             │
│       │                     │     CoffeeSold     │             │
│       │                     │                     │             │
│       │  8. Confirmação     │                     │             │
│       │◄────────────────────│                     │             │
│       │                     │                     │             │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 5. Fluxo de Redeem (Resgate Físico)

```
┌─────────────────────────────────────────────────────────────────┐
│                   FLUXO DE REDEEM                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────┐                                                   │
│  │  OWNER  │                                                   │
│  │   NFT   │                                                   │
│  └────┬────┘                                                   │
│       │                                                         │
│       │ 1. Solicita redeem                                     │
│       ▼                                                         │
│  ┌─────────────┐                                               │
│  │  Informa    │                                               │
│  │  Endereço   │                                               │
│  │  de Envio   │                                               │
│  └──────┬──────┘                                               │
│         │                                                       │
│         │ 2. Chama redeemCoffee()                              │
│         ▼                                                       │
│  ┌─────────────┐                                               │
│  │   SMART     │                                               │
│  │  CONTRACT   │                                               │
│  │ ─────────── │                                               │
│  │ • Verifica  │                                               │
│  │   owner     │                                               │
│  │ • Marca     │                                               │
│  │   redeemed  │                                               │
│  │ • Emite     │                                               │
│  │   evento    │                                               │
│  └──────┬──────┘                                               │
│         │                                                       │
│         │ 3. Evento CoffeeRedeemed                             │
│         ▼                                                       │
│  ┌─────────────┐                                               │
│  │    N8N      │                                               │
│  │  WORKFLOW   │                                               │
│  │ ─────────── │                                               │
│  │ • Captura   │                                               │
│  │   evento    │                                               │
│  │ • Notifica  │                                               │
│  │   armazém   │                                               │
│  └──────┬──────┘                                               │
│         │                                                       │
│         │ 4. Ordem de envio                                    │
│         ▼                                                       │
│  ┌─────────────┐                                               │
│  │  ARMAZÉM    │                                               │
│  │ ─────────── │                                               │
│  │ • Separa    │                                               │
│  │   lote      │                                               │
│  │ • Embala    │                                               │
│  │ • Envia     │                                               │
│  └──────┬──────┘                                               │
│         │                                                       │
│         │ 5. Tracking                                          │
│         ▼                                                       │
│  ┌─────────────┐                                               │
│  │  ENTREGA    │                                               │
│  │   FÍSICA    │                                               │
│  └─────────────┘                                               │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 6. Fluxo de Financiamento Antecipado

```
┌─────────────────────────────────────────────────────────────────┐
│              FINANCIAMENTO ANTECIPADO (PRÉ-SAFRA)               │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│     PRODUTOR          PLATAFORMA          INVESTIDOR            │
│     ────────          ──────────          ──────────            │
│         │                 │                   │                 │
│         │  1. Cadastra    │                   │                 │
│         │     safra       │                   │                 │
│         │     futura      │                   │                 │
│         │────────────────►│                   │                 │
│         │                 │                   │                 │
│         │                 │  2. Valida       │                 │
│         │                 │     histórico    │                 │
│         │                 │                   │                 │
│         │  3. Aprovado    │                   │                 │
│         │◄────────────────│                   │                 │
│         │                 │                   │                 │
│         │                 │  4. Lista NFT    │                 │
│         │                 │     pré-safra    │                 │
│         │                 │─────────────────►│                 │
│         │                 │                   │                 │
│         │                 │  5. Compra NFT   │                 │
│         │                 │◄─────────────────│                 │
│         │                 │                   │                 │
│         │  6. Recebe      │                   │                 │
│         │     adiantamento│                   │                 │
│         │     (70%)       │                   │                 │
│         │◄────────────────│                   │                 │
│         │                 │                   │                 │
│         │                 │                   │                 │
│   ══════╪═════════════════╪═══════════════════╪══════════       │
│         │        APÓS COLHEITA               │                 │
│   ══════╪═════════════════╪═══════════════════╪══════════       │
│         │                 │                   │                 │
│         │  7. Entrega     │                   │                 │
│         │     lote real   │                   │                 │
│         │────────────────►│                   │                 │
│         │                 │                   │                 │
│         │                 │  8. Auditoria    │                 │
│         │                 │     qualidade    │                 │
│         │                 │                   │                 │
│         │  9. Recebe      │                   │                 │
│         │     saldo (30%) │                   │                 │
│         │◄────────────────│                   │                 │
│         │                 │                   │                 │
│         │                 │  10. NFT ativo   │                 │
│         │                 │      para        │                 │
│         │                 │      redeem      │                 │
│         │                 │─────────────────►│                 │
│         │                 │                   │                 │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

*Documento técnico - CAFÉTOKEN © 2024*

